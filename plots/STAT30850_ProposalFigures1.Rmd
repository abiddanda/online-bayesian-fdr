---
header-includes:
   - \usepackage{amsmath}
   - \usepackage{amsthm}
fontsize: 11pt
output: pdf_document
---

# Sequential Estimation of $\hat{\pi}^t_0$

```{r, echo=FALSE}
source("../src/simulation/simulate_mixture.R")
source("../src/analysis/online-methods.R")
N <- 10000
pi0 <- 0.90
tau <- 100
t <- seq(tau, N)
initial.df <- sim.mixture.2comp(N, pi0, 0, 1, 2, 1)
plot(t, estimate.nulls.sequential(initial.df$P, lambda=0.5), ylim=c(0,1), ylab="pi0", type='l')
abline(h=pi0, lty=2)
lines(t, estimate.nulls.sequential(initial.df$P, lambda=0.75), type='l', col='red')
lines(t, estimate.nulls.sequential(initial.df$P, lambda = 0.90), type='l', col='blue')
legend("bottomright", c("0.5","0.75", "0.90"), lty=c(1,1,1), lwd=c(2.5,2.5,2.5), col=c("black","red", "blue"))
```

Here we track the sequential estimations of $\hat{\pi}_0$ through time t. Here we have the estimation for $\lambda \in \{0.5,0.75, 0.9\}$ 
