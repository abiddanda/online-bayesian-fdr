---
header-includes:
   - \usepackage{amsmath}
   - \usepackage{amsthm}
fontsize: 11pt
output: pdf_document
---

# Sequential Estimation of $\hat{\pi}^t_0$

```{r, echo=FALSE, warning=FALSE}
source("../src/simulation/simulate_mixture.R")
source("../src/analysis/online-methods.R")
N <- 10000
pi0 <- 0.90
tau <- 500
t <- seq(tau, N)
initial.df <- sim.mixture.2comp(N, pi0, 0, 1, 2, 1)
nulls.lambda50 <- estimate.nulls.sequential(initial.df$P, lambda=0.5, tau=tau)
nulls.lambda75 <- estimate.nulls.sequential(initial.df$P, lambda=0.75, tau=tau)
nulls.lambda90 <- estimate.nulls.sequential(initial.df$P, lambda=0.90, tau=tau)
err.nulls.50 <- abs(nulls.lambda50 - pi0)
err.nulls.75 <- abs(nulls.lambda75  - pi0)
err.nulls.90 <- abs(nulls.lambda90 - pi0)

par(mfrow=c(1,2))
plot(t, nulls.lambda50, ylim=c(0,1), ylab="pi0", type='l')
abline(h=pi0, lty=2)
lines(t, nulls.lambda75, type='l', col='red')
lines(t, nulls.lambda90, type='l', col='blue')
legend("bottomright", c("0.5","0.75", "0.90"), lty=c(1,1,1), lwd=c(2.5,2.5,2.5), col=c("black","red", "blue"))

# Plotting the log errors
plot(t,  -log(err.nulls.50), ylim=c(0,10), ylab="abs(Error)", type='l')
lines(t, -log(err.nulls.75), type='l', col='red')
lines(t, -log(err.nulls.90), type='l', col='blue')
legend("bottomright", c("0.5","0.75", "0.90"), lty=c(1,1,1), lwd=c(2.5,2.5,2.5), col=c("black","red", "blue"))
```

Here we track the sequential estimations of $\hat{\pi}_0$ through time t. Here we have the estimation for $\lambda \in \{0.5,0.75, 0.9\}$. These values are plotted alongside the negative-log of the absolute error. 
